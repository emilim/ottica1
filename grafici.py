import pandas as pd
import matplotlib.pyplot as plt
import numpy as np


x = np.array([ 0.0673643, 0.0503914, 0.0402501, 0.0335068, 0.0250975, 0.0222992, 0.0200623, 0.0182333, 0.0167099, 0.0154215, 0.0143175, 0.013361, 0.0125243, 0.0117862, 0.0111303, 0.0105436, 0.0100156, 0.00953792, 0.059366, 0.0457778, 0.0372513, 0.0314024, 0.027141, 0.0238979, 0.0213471, 0.0192884])
y = np.array([ 0.125492, 0.140476, 0.151088, 0.157019, 0.164781, 0.167542, 0.167542, 0.170396, 0.171861, 0.17335, 0.176408, 0.174866, 0.17640, 0.177978, 0.176408, 0.179576, 0.177978, 0.179576, 0.130401, 0.145589, 0.154591, 0.159524, 0.163434, 0.167542, 0.16615, 0.171861])
s_x = np.array([0.000321771, 0.00018005, 0.000114874, 7.96076e-05, 4.4663e-05, 3.52587e-05, 2.85398e-05, 2.35732e-05, 1.97987e-05, 1.68632e-05, 1.45352e-05, 1.2658e-05, 1.11223e-05, 9.85006e-06, 8.78422e-06, 7.88247e-06, 7.11276e-06, 6.45053e-06, 0.000249898, 0.000148593, 9.83948e-05, 6.99221e-05, 5.22323e-05, 4.04956e-05, 3.23123e-05, 2.63803e-05])
s_y = np.array([0.00111665, 0.00139924, 0.00161863, 0.001748, 0.00192531, 0.00199037, 0.00199037, 0.00205878, 0.00209431, 0.0021307, 0.00220661, 0.0021682, 0.00220661, 0.00224606, 0.00220661, 0.00228658, 0.00224606, 0.00228658, 0.00120573, 0.00150295, 0.00169457, 0.0018044, 0.00189398, 0.00199037, 0.00195744, 0.00209431])
p = np.array([14.8447, 19.8447, 24.8447, 29.8447, 34.8447, 39.8447, 44.8447, 49.8447, 54.8447, 59.8447, 64.8447, 69.8447, 74.8447, 79.8447, 84.8447, 89.8447, 94.8447, 99.8447, 104.845, 16.8447, 21.8447, 26.8447, 31.8447, 36.8447, 41.8447, 46.8447, 51.8447])
q = np.array([7.96867, 7.11867, 6.61867, 6.36867, 6.01867, 6.06867, 5.96867, 5.96867, 5.86867, 5.81867, 5.76867, 5.66867, 5.71867, 5.66867, 5.61867, 5.66867, 5.56867, 5.61867, 5.56867, 7.66867, 6.86867, 6.46867, 6.26867, 6.11867, 5.96867, 6.01867, 5.81867])

# Determina il range di x per la retta
x_retta = np.linspace(x.min(), x.max(), 500)
y_retta = -x_retta + 0.190024

# Crea il grafico
plt.figure(figsize=(10, 6))
plt.scatter(x, y, color= "blue", alpha=0.7)
plt.plot(x_retta, y_retta, label=f"Retta interpolante Y= -X + A_0", color='red')
plt.errorbar(x, y, color='blue', alpha=0.7, yerr=s_y, ecolor='green',fmt='o', capsize=5)
plt.errorbar(x, y, color='blue', alpha=0.7, xerr= s_x, ecolor='orange', fmt='o', capsize=5)
plt.xlabel("X")
plt.ylabel("Y")
plt.title("Linearizzazione del problema e interpolazione")
plt.legend()
plt.grid(True)
plt.show()

plt.figure()
plt.scatter(p , q, color= "blue", alpha=0.7)
plt.show()